
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Работа с ролями сервера. Работа с фиксированными ролями базы данных. Назначение пользовательских ролей базы данных</title>
    <style>

        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.5;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .definition {
            margin-bottom: 20px;
        }
        
        .term {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .description {
            margin-left: 20px;
        }
    </style>
    
</head>
<body>
    <header>
        <h1>Работа с ролями сервера. Работа с фиксированными ролями базы данных. Назначение пользовательских ролей базы данных</h1>
        <p><strong>Цель лекции:</strong> Изучить систему ролевой безопасности в СУБД, понять разницу между ролями сервера и ролями базы данных, освоить методы назначения прав доступа.</p>
    </header>
    <main> 
        <section id="users">
            <h2>Пользователи и права доступа в БД</h2>
            <p>Рассмотрим тему на примере банковского приложения, где хранятся персональные данные клиентов, финансовые операции и конфиденциальная информация.</p>
            
            <h3>Типы пользователей в банковской системе:</h3>
            <ul>
                <li><strong>Администратор базы данных:</strong> IT-сотрудник с полными правами на управление БД</li>
                <li><strong>Диспетчер / личный менеджер:</strong> Сотрудник с доступом к просмотру информации о клиентах</li>
                <li><strong>Супервайзер:</strong> Руководитель с расширенными правами для изменения данных клиентов</li>
            </ul>

            <h3>Почему необходимо разделение прав:</h3>
            <ol>
                <li><strong>Безопасность:</strong> Предотвращение несанкционированного доступа к данным</li>
                <li><strong>Контроль:</strong> Отслеживание операций через журнал аудита</li>
                <li><strong>Эффективность:</strong> Организация работы с данными согласно должностным обязанностям</li>
            </ol>

            <h3>Пример: изменение данных клиента</h3>
            <ul>
                <li><strong>Диспетчер:</strong> Только просмотр информации</li>
                <li><strong>Супервайзер:</strong> Может изменять контактные данные клиента</li>
                <li><strong>Администратор:</strong> Полные права на изменение любых данных</li>
            </ul>
        </section>

        <section id="introduction">
            <h2>1. Введение в ролевую безопасность</h2>
            <p>В современных СУБД управление правами доступа осуществляется через <strong>роли</strong> — именованный набор привилегий, который можно назначить пользователю.</p>
            
            <h3>Два уровня ролей:</h3>
            <ol>
                <li><strong>Роли уровня сервера</strong> — управляют правами на уровне всего экземпляра СУБД</li>
                <li><strong>Роли уровня базы данных</strong> — управляют правами в рамках конкретной базы данных</li>
            </ol>
        </section>

        <section id="server-roles">
            <h2>2. Роли уровня сервера</h2>
            <p>Эти роли предназначены для администрирования самого сервера баз данных и существуют вне конкретных баз данных.</p>
            
            <h3>Примеры фиксированных серверных ролей в SQL Server:</h3>
            <table border="1">
                <tr>
                    <th>Роль</th>
                    <th>Описание</th>
                </tr>
                <tr>
                    <td><strong>sysadmin</strong></td>
                    <td>Выполняет любые действия на сервере (аналогична root в Linux)</td>
                </tr>
                <tr>
                    <td><strong>serveradmin</strong></td>
                    <td>Может изменять конфигурации сервера и останавливать его</td>
                </tr>
                <tr>
                    <td><strong>securityadmin</strong></td>
                    <td>Управляет именами входа (логинами) на уровне сервера</td>
                </tr>
                <tr>
                    <td><strong>processadmin</strong></td>
                    <td>Может завершать процессы на сервере</td>
                </tr>
                <tr>
                    <td><strong>setupadmin</strong></td>
                    <td>Управляет связанными серверами и запускаемыми процедурами</td>
                </tr>
                <tr>
                    <td><strong>bulkadmin</strong></td>
                    <td>Может выполнять операции массового импорта данных</td>
                </tr>
                <tr>
                    <td><strong>diskadmin</strong></td>
                    <td>Управляет файлами дисков</td>
                </tr>
                <tr>
                    <td><strong>dbcreator</strong></td>
                    <td>Может создавать, изменять и удалять базы данных</td>
                </tr>
                <tr>
                    <td><strong>public</strong></td>
                    <td>Базовая роль, в которую по умолчанию входят все логины</td>
                </tr>
            </table>

            <h3>Назначение серверной роли пользователю:</h3>
            <pre>
-- Синтаксис для SQL Server
ALTER SERVER ROLE [sysadmin] ADD MEMBER [ИмяЛогина];

-- Синтаксис для PostgreSQL
CREATE ROLE admin_role WITH LOGIN SUPERUSER;
            </pre>
            <p><strong>Важно:</strong> Наделение пользователя мощными серверными ролями должно быть строго обосновано.</p>
        </section>

        <section id="database-roles">
            <h2>3. Роли уровня базы данных</h2>
            <p>Эти роли действуют в контексте конкретной базы данных и управляют правами на доступ к ее объектам.</p>
            
            <h3>3.1. Фиксированные роли базы данных</h3>
            <p>Предопределенные роли с уже настроенным набором привилегий.</p>
            
            <table border="1">
                <tr>
                    <th>Роль</th>
                    <th>Описание</th>
                </tr>
                <tr>
                    <td><strong>db_owner</strong></td>
                    <td>Имеет все права в базе данных</td>
                </tr>
                <tr>
                    <td><strong>db_securityadmin</strong></td>
                    <td>Управляет членством в ролях и правами доступа</td>
                </tr>
                <tr>
                    <td><strong>db_accessadmin</strong></td>
                    <td>Добавляет или удаляет доступ для логинов к БД</td>
                </tr>
                <tr>
                    <td><strong>db_backupoperator</strong></td>
                    <td>Может создавать резервные копии базы данных</td>
                </tr>
                <tr>
                    <td><strong>db_ddladmin</strong></td>
                    <td>Может выполнять команды DDL (CREATE, ALTER, DROP)</td>
                </tr>
                <tr>
                    <td><strong>db_datawriter</strong></td>
                    <td>Может добавлять, изменять и удалять данные во всех таблицах</td>
                </tr>
                <tr>
                    <td><strong>db_datareader</strong></td>
                    <td>Может читать данные из всех пользовательских таблиц</td>
                </tr>
                <tr>
                    <td><strong>db_denydatawriter</strong></td>
                    <td>Не может изменять данные в таблицах</td>
                </tr>
                <tr>
                    <td><strong>db_denydatareader</strong></td>
                    <td>Не может читать данные из таблиц</td>
                </tr>
                <tr>
                    <td><strong>public</strong></td>
                    <td>Все пользователи БД являются членами этой роли</td>
                </tr>
            </table>

            <h3>Назначение фиксированной роли базы данных:</h3>
            <pre>
-- В SQL Server
EXEC sp_addrolemember 'db_datareader', 'ИмяПользователяВБД';

-- Современный синтаксис
ALTER ROLE [db_datareader] ADD MEMBER [ИмяПользователяВБД];
            </pre>

            <h3>3.2. Пользовательские роли базы данных</h3>
            <p>Создаются администратором для реализации сложной политики безопасности.</p>
            
            <h4>Пример создания пользовательской роли:</h4>
            <pre>
-- 1. Создать роль
CREATE ROLE [МенеджерПродаж];

-- 2. Назначить роли привилегии
GRANT SELECT, INSERT, UPDATE ON [dbo].[Orders] TO [МенеджерПродаж];
GRANT SELECT ON [dbo].[Customers] TO [МенеджерПродаж];

-- 3. Запретить определенные действия
DENY DELETE ON [dbo].[Orders] TO [МенеджерПродаж];

-- 4. Добавить пользователя в роль
ALTER ROLE [МенеджерПродаж] ADD MEMBER [Иван];
            </pre>
        </section>

        <section id="hierarchy">
            <h2>4. Иерархия прав доступа и принцип наименьших привилегий</h2>
            
            <h3>Приоритет прав:</h3>
            <ol>
                <li><strong>Запрет (DENY)</strong> — наивысший приоритет, перекрывает любое разрешение</li>
                <li><strong>Разрешение (GRANT)</strong> — дает право на действие</li>
                <li><strong>Лишение права (REVOKE)</strong> — отменяет ранее выданное разрешение или запрет</li>
            </ol>

            <h3>Принцип наименьших привилегий:</h3>
            <p>Пользователю должна быть предоставлена ровно та степень доступа, которая необходима для выполнения его рабочих задач, и не более.</p>
            
            <h4>Пример:</h4>
            <p>Пользователю <strong>Иван</strong> нужно только читать данные из таблицы <strong>Products</strong>.</p>
            <ul>
                <li><strong>Правильно:</strong> Добавить его в роль <strong>db_datareader</strong> или создать роль только для чтения</li>
                <li><strong>Неправильно:</strong> Делать его <strong>db_owner</strong> или <strong>db_datawriter</strong></li>
            </ul>
        </section>

        <section id="recommendations">
            <h2>5. Практические рекомендации</h2>
            <ol>
                <li><strong>Избегайте прямого назначения прав пользователям.</strong> Всегда используйте роли.</li>
                <li><strong>Используйте встроенные фиксированные роли</strong> для стандартных задач администрирования.</li>
                <li><strong>Создавайте собственные роли</strong> для реализации бизнес-логики и сложных требований безопасности.</li>
                <li><strong>Регулярно проводите аудит</strong> прав доступа.</li>
                <li><strong>Документируйте</strong> созданные роли и назначенные им права.</li>
            </ol>
        </section>

        <section id="conclusion">
            <h2>Заключение</h2>
            <p>Правильное управление ролями — краеугольный камень безопасности и эффективного администрирования любой информационной системы, построенной на основе СУБД. Понимание разницы между серверными и базы данных ролями, а также владение инструментами их настройки является обязательным навыком для специалиста по сопровождению ИС.</p>
        </section>
    </main>
</body>


</html>
    </style>
</head>
<body>
    <header>
        <h1>Работа с ролями сервера. Работа с фиксированными ролями базы данных. Назначение пользовательских ролей базы данных</h1>
        <p><strong>Цель лекции:</strong> Изучить систему ролевой безопасности в СУБД, понять разницу между ролями сервера и ролями базы данных, освоить методы назначения прав доступа.</p>
    </header>
    <main> 
        <section id="users">
            <h2>Пользователи и права доступа в БД</h2>
            <p>Рассмотрим тему на примере банковского приложения, где хранятся персональные данные клиентов, финансовые операции и конфиденциальная информация.</p>
            
            <h3>Типы пользователей в банковской системе:</h3>
            <ul>
                <li><strong>Администратор базы данных:</strong> IT-сотрудник с полными правами на управление БД</li>
                <li><strong>Диспетчер / личный менеджер:</strong> Сотрудник с доступом к просмотру информации о клиентах</li>
                <li><strong>Супервайзер:</strong> Руководитель с расширенными правами для изменения данных клиентов</li>
            </ul>

            <h3>Почему необходимо разделение прав:</h3>
            <ol>
                <li><strong>Безопасность:</strong> Предотвращение несанкционированного доступа к данным</li>
                <li><strong>Контроль:</strong> Отслеживание операций через журнал аудита</li>
                <li><strong>Эффективность:</strong> Организация работы с данными согласно должностным обязанностям</li>
            </ol>

            <h3>Пример: изменение данных клиента</h3>
            <ul>
                <li><strong>Диспетчер:</strong> Только просмотр информации</li>
                <li><strong>Супервайзер:</strong> Может изменять контактные данные клиента</li>
                <li><strong>Администратор:</strong> Полные права на изменение любых данных</li>
            </ul>
        </section>

        <section id="introduction">
            <h2>1. Введение в ролевую безопасность</h2>
            <p>В современных СУБД управление правами доступа осуществляется через <strong>роли</strong> — именованный набор привилегий, который можно назначить пользователю.</p>
            
            <h3>Два уровня ролей:</h3>
            <ol>
                <li><strong>Роли уровня сервера</strong> — управляют правами на уровне всего экземпляра СУБД</li>
                <li><strong>Роли уровня базы данных</strong> — управляют правами в рамках конкретной базы данных</li>
            </ol>
        </section>

        <section id="server-roles">
            <h2>2. Роли уровня сервера</h2>
            <p>Эти роли предназначены для администрирования самого сервера баз данных и существуют вне конкретных баз данных.</p>
            
            <h3>Примеры фиксированных серверных ролей в SQL Server:</h3>
            <table border="1">
                <tr>
                    <th>Роль</th>
                    <th>Описание</th>
                </tr>
                <tr>
                    <td><strong>sysadmin</strong></td>
                    <td>Выполняет любые действия на сервере (аналогична root в Linux)</td>
                </tr>
                <tr>
                    <td><strong>serveradmin</strong></td>
                    <td>Может изменять конфигурации сервера и останавливать его</td>
                </tr>
                <tr>
                    <td><strong>securityadmin</strong></td>
                    <td>Управляет именами входа (логинами) на уровне сервера</td>
                </tr>
                <tr>
                    <td><strong>processadmin</strong></td>
                    <td>Может завершать процессы на сервере</td>
                </tr>
                <tr>
                    <td><strong>setupadmin</strong></td>
                    <td>Управляет связанными серверами и запускаемыми процедурами</td>
                </tr>
                <tr>
                    <td><strong>bulkadmin</strong></td>
                    <td>Может выполнять операции массового импорта данных</td>
                </tr>
                <tr>
                    <td><strong>diskadmin</strong></td>
                    <td>Управляет файлами дисков</td>
                </tr>
                <tr>
                    <td><strong>dbcreator</strong></td>
                    <td>Может создавать, изменять и удалять базы данных</td>
                </tr>
                <tr>
                    <td><strong>public</strong></td>
                    <td>Базовая роль, в которую по умолчанию входят все логины</td>
                </tr>
            </table>

            <h3>Назначение серверной роли пользователю:</h3>
            <pre>
-- Синтаксис для SQL Server
ALTER SERVER ROLE [sysadmin] ADD MEMBER [ИмяЛогина];

-- Синтаксис для PostgreSQL
CREATE ROLE admin_role WITH LOGIN SUPERUSER;
            </pre>
            <p><strong>Важно:</strong> Наделение пользователя мощными серверными ролями должно быть строго обосновано.</p>
        </section>

        <section id="database-roles">
            <h2>3. Роли уровня базы данных</h2>
            <p>Эти роли действуют в контексте конкретной базы данных и управляют правами на доступ к ее объектам.</p>
            
            <h3>3.1. Фиксированные роли базы данных</h3>
            <p>Предопределенные роли с уже настроенным набором привилегий.</p>
            
            <table border="1">
                <tr>
                    <th>Роль</th>
                    <th>Описание</th>
                </tr>
                <tr>
                    <td><strong>db_owner</strong></td>
                    <td>Имеет все права в базе данных</td>
                </tr>
                <tr>
                    <td><strong>db_securityadmin</strong></td>
                    <td>Управляет членством в ролях и правами доступа</td>
                </tr>
                <tr>
                    <td><strong>db_accessadmin</strong></td>
                    <td>Добавляет или удаляет доступ для логинов к БД</td>
                </tr>
                <tr>
                    <td><strong>db_backupoperator</strong></td>
                    <td>Может создавать резервные копии базы данных</td>
                </tr>
                <tr>
                    <td><strong>db_ddladmin</strong></td>
                    <td>Может выполнять команды DDL (CREATE, ALTER, DROP)</td>
                </tr>
                <tr>
                    <td><strong>db_datawriter</strong></td>
                    <td>Может добавлять, изменять и удалять данные во всех таблицах</td>
                </tr>
                <tr>
                    <td><strong>db_datareader</strong></td>
                    <td>Может читать данные из всех пользовательских таблиц</td>
                </tr>
                <tr>
                    <td><strong>db_denydatawriter</strong></td>
                    <td>Не может изменять данные в таблицах</td>
                </tr>
                <tr>
                    <td><strong>db_denydatareader</strong></td>
                    <td>Не может читать данные из таблиц</td>
                </tr>
                <tr>
                    <td><strong>public</strong></td>
                    <td>Все пользователи БД являются членами этой роли</td>
                </tr>
            </table>

            <h3>Назначение фиксированной роли базы данных:</h3>
            <pre>
-- В SQL Server
EXEC sp_addrolemember 'db_datareader', 'ИмяПользователяВБД';

-- Современный синтаксис
ALTER ROLE [db_datareader] ADD MEMBER [ИмяПользователяВБД];
            </pre>

            <h3>3.2. Пользовательские роли базы данных</h3>
            <p>Создаются администратором для реализации сложной политики безопасности.</p>
            
            <h4>Пример создания пользовательской роли:</h4>
            <pre>
-- 1. Создать роль
CREATE ROLE [МенеджерПродаж];

-- 2. Назначить роли привилегии
GRANT SELECT, INSERT, UPDATE ON [dbo].[Orders] TO [МенеджерПродаж];
GRANT SELECT ON [dbo].[Customers] TO [МенеджерПродаж];

-- 3. Запретить определенные действия
DENY DELETE ON [dbo].[Orders] TO [МенеджерПродаж];

-- 4. Добавить пользователя в роль
ALTER ROLE [МенеджерПродаж] ADD MEMBER [Иван];
            </pre>
        </section>

        <section id="hierarchy">
            <h2>4. Иерархия прав доступа и принцип наименьших привилегий</h2>
            
            <h3>Приоритет прав:</h3>
            <ol>
                <li><strong>Запрет (DENY)</strong> — наивысший приоритет, перекрывает любое разрешение</li>
                <li><strong>Разрешение (GRANT)</strong> — дает право на действие</li>
                <li><strong>Лишение права (REVOKE)</strong> — отменяет ранее выданное разрешение или запрет</li>
            </ol>

            <h3>Принцип наименьших привилегий:</h3>
            <p>Пользователю должна быть предоставлена ровно та степень доступа, которая необходима для выполнения его рабочих задач, и не более.</p>
            
            <h4>Пример:</h4>
            <p>Пользователю <strong>Иван</strong> нужно только читать данные из таблицы <strong>Products</strong>.</p>
            <ul>
                <li><strong>Правильно:</strong> Добавить его в роль <strong>db_datareader</strong> или создать роль только для чтения</li>
                <li><strong>Неправильно:</strong> Делать его <strong>db_owner</strong> или <strong>db_datawriter</strong></li>
            </ul>
        </section>

        <section id="recommendations">
            <h2>5. Практические рекомендации</h2>
            <ol>
                <li><strong>Избегайте прямого назначения прав пользователям.</strong> Всегда используйте роли.</li>
                <li><strong>Используйте встроенные фиксированные роли</strong> для стандартных задач администрирования.</li>
                <li><strong>Создавайте собственные роли</strong> для реализации бизнес-логики и сложных требований безопасности.</li>
                <li><strong>Регулярно проводите аудит</strong> прав доступа.</li>
                <li><strong>Документируйте</strong> созданные роли и назначенные им права.</li>
            </ol>
        </section>

        <section id="conclusion">
            <h2>Заключение</h2>
            <p>Правильное управление ролями — краеугольный камень безопасности и эффективного администрирования любой информационной системы, построенной на основе СУБД. Понимание разницы между серверными и базы данных ролями, а также владение инструментами их настройки является обязательным навыком для специалиста по сопровождению ИС.</p>
        </section>
    </main>
</body>


</html>